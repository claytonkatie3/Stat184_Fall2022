---
title: "Data Scraping and Collaboration"
author: "Katie Clayton with Ian Munoz"
date: "`r Sys.Date()`"
output:
  html_notebook:
    code folding: hide
  word_document: default
  pdf_document: default
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r loadpackages, include=FALSE}
# load packages
library(rvest)
library(dplyr)
library(readr)
library(ggplot2)
library(tidyr)
```

```{r HGMdata}
# highest grossing movies data
highestgrossingMovies <- read_html(
  # incorporate the URL
  x = "https://www.boxofficemojo.com/chart/top_lifetime_gross/?area=XWW"
) %>%
  html_elements(css = "table") %>%
  html_table()
## use element 1
```

```{r RTRdata}
# rotten tomato ratings of the highest grossing movies data 
library(readxl)
# pull table from excel
rottenTomatoes <- read_excel("~/Desktop/rottenTomatoes.xlsx")
# convert it to a data frame
tomatoDataFrame <- data.frame(rottenTomatoes)
```

```{r wrangleHGMdata}
# column bind the box office gross using element 1
boxofficeGross <- bind_cols(highestgrossingMovies[[1]])
```

```{r JoinData}
# join data 
MoviesInBoxOffice <- inner_join(
  x = boxofficeGross,
  y = tomatoDataFrame,
  by = ("Title" = "Title")
)
```

```{r create visualization, fig.cap= "Lifetime Gross vs Rotten Tomato Rating of the Top 10 Highest Grossing Movies"}
# create the visualization
ggplot(MoviesInBoxOffice,
       # assign variables to axes
       mapping = aes(x = Rotten.Tomato.Rating, y = `Lifetime Gross`, colour = Title)
  ) +
  geom_point(shape = "circle", size = 4L) +
  scale_color_hue(direction = 1) +
  # label axes
  labs(
    x = "Rotten Tomato Rating",
    y = "Lifetime Gross"
  )+
  theme_minimal()
```

This visualization shows the relationship between the top 10 Highest Grossing Movies and their rating on Rotten Tomatoes. The question that the visualization aims to answer is, is a movie's rating on Rotten Tomatoes correlated with its lifetime Gross? Given the small sample size of movies, an accurate relationship is hard to confirm. But, a positive relationship between rating and lifetime gross is appearing in this visualization. Meaning that, the higher a movie is rated on Rotten Tomatoes, the higher its lifetime gross is.
